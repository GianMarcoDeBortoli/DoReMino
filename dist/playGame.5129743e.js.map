{"version":3,"sources":["timer.js","playGame.js"],"names":["FULL_DASH_ARRAY","WARNING_THRESHOLD","ALERT_THRESHOLD","COLOR_CODES","info","color","warning","threshold","alert","TIME_LIMIT","timePassed","timeLeft","timerInterval","remainingPathColor","document","getElementById","innerHTML","formatTime","onTimesUp","clearInterval","fPlayGame","submit","startTimer","setInterval","setCircleDasharray","setRemainingPathColor","time","minutes","Math","floor","seconds","classList","remove","add","calculateTimeFraction","rawTimeFraction","circleDasharray","toFixed","setAttribute","modelLength","grades","tiles","querySelectorAll","setPieces","pieceNum","colors","colorsAvailable","lowerGrades","barContainer","result","hiddenField","createElement","appendChild","boxesPerRow","dim1","dim2","spaceBetweenBoxes","rows","rowHeight","tableWidth","tableHeight","table","parseGetVars","params","URLSearchParams","location","search","substring","modal","get","mode","createTile","color1","color2","i","tile","id","addEventListener","drag","event","tileUpper","tileLower","call_rotate","createSet","length","number1","random","number2","piece","grade1","grade2","angle","push","add_rows","num","height","row","style","flexFlow","horiz_box","box","width","vert_box","add_boxes","numRows","numBoxes","cntbox","j","textContent","draw_table","firstPainfulRender","iterate_angle","n","rotate","ev","Array","from","currentTarget","parentNode","children","indexOf","firstElementChild","lastElementChild","firstChild","removeChild","lastChild","tempGrade","console","log","change_set","changeSet","onclick","rowCollection","boxes","rowChild","add_drop","drop","add_prevent_drop","prevent_drop","preventDefault","dataTransfer","setData","target","drop_box","array","cartoonFeedback","data","getData","addToSequence","splice","removeEventListener","join","feedback","cartoon","display","setTimeout","timer"],"mappings":"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","file":"playGame.5129743e.js","sourceRoot":"..","sourcesContent":["//------------------------- TIMER MODEL ------------------------------------------------\nconst FULL_DASH_ARRAY = 283;\nconst WARNING_THRESHOLD = 10;\nconst ALERT_THRESHOLD = 5;\n\nconst COLOR_CODES = {\n  info: {\n    color: \"green\"\n  },\n  warning: {\n    color: \"orange\",\n    threshold: WARNING_THRESHOLD\n  },\n  alert: {\n    color: \"red\",\n    threshold: ALERT_THRESHOLD\n  }\n};\n\nconst TIME_LIMIT = 120;\nlet timePassed = 0;\nlet timeLeft = TIME_LIMIT;\nlet timerInterval = null;\nlet remainingPathColor = COLOR_CODES.info.color;\n\ndocument.getElementById(\"timer\").innerHTML = `\n<div class=\"base-timer\">\n  <svg class=\"base-timer__svg\" viewBox=\"0 0 100 100\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g class=\"base-timer__circle\">\n      <circle class=\"base-timer__path-elapsed\" cx=\"50\" cy=\"50\" r=\"45\"></circle>\n      <path\n        id=\"base-timer-path-remaining\"\n        stroke-dasharray=\"283\"\n        class=\"base-timer__path-remaining ${remainingPathColor}\"\n        d=\"\n          M 50, 50\n          m -45, 0\n          a 45,45 0 1,0 90,0\n          a 45,45 0 1,0 -90,0\n        \"\n      ></path>\n    </g>\n  </svg>\n  <span id=\"base-timer-label\" class=\"base-timer__label\">${formatTime(\n    timeLeft\n  )}</span>\n</div>\n`;\n//------------------------- END TIMER MODEL ------------------------------------------------\n\nfunction onTimesUp() {\n  clearInterval(timerInterval);\n  // qua devo scrivere il codice per fare la stessa cosa che faccio se clicco su Finish Game\n  //hiddenField2.setAttribute(\"type\", \"submit\");\n  //hiddenField2.setAttribute(\"name\", \"end\");\n  //document.getElementById(\"fPlayGame\").appendChild(hiddenField2);\n  document.fPlayGame.submit();\n}\n\nexport function startTimer() {\n  timerInterval = setInterval(() => {\n    timePassed = timePassed += 1;\n    timeLeft = TIME_LIMIT - timePassed;\n    document.getElementById(\"base-timer-label\").innerHTML = formatTime(\n      timeLeft\n    );\n    setCircleDasharray();\n    setRemainingPathColor(timeLeft);\n\n    if (timeLeft === 0) {\n      onTimesUp();\n    }\n  }, 1000);\n}\n\nfunction formatTime(time) {\n  const minutes = Math.floor(time / 60);\n  let seconds = time % 60;\n\n  if (seconds < 10) {\n    seconds = `0${seconds}`;\n  }\n\n  return `${minutes}:${seconds}`;\n}\n\nfunction setRemainingPathColor(timeLeft) {\n  const { alert, warning, info } = COLOR_CODES;\n  if (timeLeft <= alert.threshold) {\n    document\n      .getElementById(\"base-timer-path-remaining\")\n      .classList.remove(warning.color);\n    document\n      .getElementById(\"base-timer-path-remaining\")\n      .classList.add(alert.color);\n  } else if (timeLeft <= warning.threshold) {\n    document\n      .getElementById(\"base-timer-path-remaining\")\n      .classList.remove(info.color);\n    document\n      .getElementById(\"base-timer-path-remaining\")\n      .classList.add(warning.color);\n  }\n}\n\nfunction calculateTimeFraction() {\n  const rawTimeFraction = timeLeft / TIME_LIMIT;\n  return rawTimeFraction - (1 / TIME_LIMIT) * (1 - rawTimeFraction);\n}\n\nfunction setCircleDasharray() {\n  const circleDasharray = `${(\n    calculateTimeFraction() * FULL_DASH_ARRAY\n  ).toFixed(0)} 283`;\n  document\n    .getElementById(\"base-timer-path-remaining\")\n    .setAttribute(\"stroke-dasharray\", circleDasharray);\n}\n// ------------ END of TIMER controller ------------------\n","import * as timer from './timer';\n//------------------------------------------------------- MODEL -----------------------------------------------------------\nconst modelLength = 10\nvar grades = []\nlet tiles = document.querySelectorAll(\".tile\");\nvar setPieces = [] // elenco dei tiles con associati i due gradi e l'angolazione\nlet pieceNum = -1; // I need this to remove the dropped tile from setPieces array\nconst colors = [\"darkSlateBlue\",\"darkGoldenRod\", \"darkRed\", \"paleVioletRed\", \"darkGreen\",\"darkBlue\",\"lawnGreen\", \"darkSlateGray\", \"darkOrange\", \"turquoise\", \"yellow\", \"red\", \"slateBlue\", \"goldenRod\", \"fireBrick\", \"lightPink\", \"forestGreen\", \"blue\"]\n// each color is associated to a note\nlet colorsAvailable= []\n// for all grades values, I put into colorsAvailable in this game session, only a subgroup of the ones available,\n// by selecting the colors in colors corresponding to the number present in grades\nlet lowerGrades = 5; //? nome\nconst barContainer = document.getElementById(\"bar\");\nvar result = [] // array with the sequence created: everytime I add a piece to the board, the tile grade is added to result\n\n// a new element hidden in the form to pass the result as a URL parameter\nvar hiddenField = document.createElement(\"input\");\nhiddenField.setAttribute(\"type\", \"hidden\");\nhiddenField.setAttribute(\"name\", \"result\");\ndocument.getElementById(\"fPlayGame\").appendChild(hiddenField);\n\n//boxes\nconst boxesPerRow = 9;\nconst dim1 = 60;\nconst dim2 = 120;\nconst spaceBetweenBoxes = 5;\n\n//table\nconst rows = 3;\nconst rowHeight = dim2 + 10; //10 is padding\nconst tableWidth = boxesPerRow*dim2 + (boxesPerRow-1)*spaceBetweenBoxes + 20; //40 is padding\nconst tableHeight = rows * rowHeight;\n\nlet table = document.getElementById(\"table\");\n\n// function to get parameters from URL\n// URLSearchParams crea una sorta di dizionario dalla stringa data in argomento, la stringa data è la parte dell'URL che sta dopo l'uguale\n// per accedere ai valori del dizionario si usa la get(key)\nfunction parseGetVars() {\n  let params = new URLSearchParams(document.location.search.substring(1));\n  let modal = params.get(\"mode\");\n  return modal;\n}\n\nlet mode = parseGetVars();\n\n// Filling grades according to the mode received by the select input in the form by the user\nswitch(mode){\n  case \"Ionian\":\n    grades = [-5,-3,-1,0,2,4,5,7,9,11,12]\n    break;\n  case \"Dorian\":\n    grades = [-5,-3,-2,0,2,3,5,7,9,10,12]\n    break;\n  case \"Phrygian\":\n    grades = [-4,-2,-0,1,3,5,7,8,10,12]\n    break;\n  case \"Lydian\":\n    grades = [-5,-3,-1,0,2,4,6,7,9,11,12]\n  case \"Myxolydian\":\n    grades = [-5,-3,-2,0,2,4,5,7,9,10,12]\n  case \"Aeolian\":\n    grades = [-5,-4,-2,0,2,3,5,7,8,10,12]\n  case \"Locrian\":\n    grades = [-4,-2,0,1,3,5,6,8,10,12]\n}\n\n//---------------------------------------------- END of MODEL --------------------------------------------------------------\n\n//----------------------------------------------- VIEW --------------------------------------------------------------\n\n// Creates a tile of the specified color\nfunction createTile(color1,color2,i) {\n  let tile = document.createElement(\"div\");\n  tile.classList.add(\"tile_v\");\n  tile.id = i;   // L'id serve al drag\n  tile.setAttribute(\"draggable\", true)\n  tile.addEventListener(\"dragstart\",  function() {pieceNum = drag(event)})\n\n  // I create two subclasses with the lower and upper part that are of two different colors\n  const tileUpper = document.createElement(\"div\");\n  tileUpper.classList.add(\"tileUpper\",color1);\n  const tileLower = document.createElement(\"div\");\n  tileLower.classList.add(\"tileLower\",color2);\n\n  tile.appendChild(tileUpper);\n  tile.appendChild(tileLower);\n\n  tile.addEventListener(\"dblclick\", call_rotate); // non so se questo sia giusto che sia nella view ?\n\n  return tile\n\n}\n\nfunction createSet() {\n  for(let i = 0; i < grades.length; i++){\n    colorsAvailable[i] = colors[grades[i]+lowerGrades]; // for example lowerGrades=5 (as in our case) in grades, becomes 0 in colors,\n    // because I want to use the position to access colors: colors[0] corresponds always to grade -5\n  }\n\n  for (let i = 0; i < modelLength; i++) { // For each element of the model, so of the bar\n    const number1 = Math.floor(Math.random() * colorsAvailable.length)\n    const number2 = Math.floor(Math.random() * colorsAvailable.length)\n    //Math.floor() restituisce un numero intero arrotondato per difetto\n    const tile = createTile(colorsAvailable[number1],colorsAvailable[number2],i) // Create actual tile of that two colors chosen in a randomic way\n    barContainer.appendChild(tile) // Add it to the bar div\n    let piece = {\n      // all'inizio i pezzi sono sempre in verticale e assegno grade1 di default al pezzo in alto e grade2 al pezzo in basso\n      tile: tile,\n      grade1: number1-lowerGrades,\n      grade2: number2-lowerGrades,\n      angle: 0,\n    }\n\n    setPieces.push(piece)\n  }\n}\n\n//---------------------------------------- CREATION of TABLE -----------------------------------------------------------\n//prende in argomento la const table, il numero di rows e l'altezza di una row.\n//crea le rows, le disegna, aggiunge gli attributi per il flex del contenuto e le appendChilda al table.\nfunction add_rows(table, num, height) {\n  for (let i = 0; i < num; i++) {\n      let row = document.createElement(\"div\");\n      row.classList.add(\"row\");\n      row.id = \"row\"+i;\n      row.style.height = height+\"px\";\n      if (i%2 == 0) {\n          row.style.flexFlow = \"row wrap\";\n      } else {\n          row.style.flexFlow = \"row-reverse wrap\";\n      }\n      table.appendChild(row);\n  }\n}\n\n//due funzioni ausiliarie chiamate poi dalla add_boxes che disegnano i singoli box e danno gli attributi per il flex di contenuto\nfunction horiz_box(box, dim1, dim2) {\n  box.classList.add(\"box\");\n  box.style.width = dim2+\"px\";\n  box.style.height = dim1+\"px\";\n}\n\nfunction vert_box(box, dim1, dim2) {\n  box.classList.add(\"box\");\n  box.style.width = dim1+\"px\";\n  box.style.height = dim2+\"px\";\n\n}\n\n//prende in argomento il numero di rows, il numero di boxes per ogni row e le dimensioni di un box\n//prende una row alla volta per id, crea l'elemento box, chiama per i primi numBox-1 la horiz_box e per l'ultimo\n//di ogni riga la vert_box per disegnarli. Infine assegna il box alla row.\nfunction add_boxes(numRows, numBoxes, width, height) {\n  let cntbox = 0;\n\n  for (let i = 0; i < numRows; i++) {\n\n      let row = document.getElementById(\"row\"+i);\n\n      for (let j = 0; j < numBoxes-1; j++) {\n          let box = document.createElement(\"div\");\n          horiz_box(box, width, height);\n          box.textContent = cntbox;\n          box.id = cntbox;\n          cntbox++;\n          row.appendChild(box);\n      }\n\n      let box = document.createElement(\"div\");\n      vert_box(box, width, height);\n      box.textContent = cntbox;\n      box.id = cntbox;\n      cntbox++;\n      row.appendChild(box);\n  }\n}\n\n\nfunction draw_table(table, tableWidth, tableHeight, numRows, rowHeight, numBoxes, width, height) {\n  table.style.width = tableWidth+\"px\";\n  table.style.height = tableHeight+\"px\";\n  add_rows(table, numRows, rowHeight);\n  add_boxes(numRows, numBoxes, width, height)\n}\n//---------------------------------------- END of CREATION of TABLE -----------------------------------------------------------\n\n// render\nfunction firstPainfulRender() {\n  createSet();\n  draw_table(table, tableWidth, tableHeight, rows, rowHeight, boxesPerRow, dim1, dim2);\n}\n//document.write(result)\n\n//----------------------------------------------- END of VIEW --------------------------------------------------------------\n\n\n//----------------------------------------------- CONTROLLER --------------------------------------------------------------\nfirstPainfulRender()\n\n//funzione che calcola il nuovo angolo da dare al piece ruotato\nfunction iterate_angle(n) {\n  n += 90;\n  n = n % 360;\n  return n;\n}\n\nfunction call_rotate () {\n  rotate(event);\n}\n\n//in ordine: trova l'indice della tessera all'interno di setPieces passando per la bar;\n//la if serve a permettere la la rotazione anche se l'evento avviene su upper o lower;\n//controlla l'angolo del piece su cui avviene l'evento per decidere come agire;\n//se serve, scambia di posto tileupper e tilelower e i due grade all'interno del piece;\n//infine modifica l'angolo del piece\nfunction rotate(ev){\n  let i =  Array.from(ev.currentTarget.parentNode.children).indexOf(ev.currentTarget)\n  //if (ev.target == ev.currentTarget) {\n    // at the beginning I have [grade1, grade2]\n    if (setPieces[i].angle == 0) {\n      ev.currentTarget.classList.remove(\"tile_v\");\n      ev.currentTarget.classList.add(\"tile_h\");\n      //event.currentTarget.style.flexFlow = \"row-reverse wrap\"; //questa riga dovrebbe fare la stessa cosa delle seguenti sei\n      let tileUpper = ev.currentTarget.firstElementChild;\n      let tileLower = ev.currentTarget.lastElementChild;\n      while (ev.currentTarget.firstChild) {\n        ev.currentTarget.removeChild(event.currentTarget.lastChild);\n      }\n      ev.currentTarget.appendChild(tileLower);\n      ev.currentTarget.appendChild(tileUpper);\n      // I also want to swap grade1 and grade2 to have [grade2, grade1]\n      let tempGrade = setPieces[i].grade1;\n      setPieces[i].grade1 = setPieces[i].grade2;\n      setPieces[i].grade2 = tempGrade;\n    }\n    if (setPieces[i].angle == 90) {\n      ev.currentTarget.classList.remove(\"tile_h\");\n      ev.currentTarget.classList.add(\"tile_v\");\n      // I still have [grade2, grade1]\n    }\n    if (setPieces[i].angle == 180) {\n      ev.currentTarget.classList.remove(\"tile_v\");\n      ev.currentTarget.classList.add(\"tile_h\");\n      let tileUpper = ev.currentTarget.firstElementChild;\n      let tileLower = ev.currentTarget.lastElementChild;\n      while (ev.currentTarget.firstChild) {\n        ev.currentTarget.removeChild(ev.currentTarget.lastChild);\n      }\n      ev.currentTarget.appendChild(tileLower);\n      ev.currentTarget.appendChild(tileUpper);\n      // I again want to swap grade1 and grade2 to have [grade1, grade2]\n      let tempGrade = setPieces[i].grade1;\n      setPieces[i].grade1 = setPieces[i].grade2;\n      setPieces[i].grade2 = tempGrade;\n    }\n    if (setPieces[i].angle == 270) {\n      ev.currentTarget.classList.remove(\"tile_h\");\n      ev.currentTarget.classList.add(\"tile_v\");\n    }\n    setPieces[i].angle = iterate_angle(setPieces[i].angle);\n    console.log(setPieces[i]);\n  //}\n}\n\n//funzione ausiliaria che chiama la rotate per gestire l'eventListener corrispondente\n\n\nfunction change_set() {\n  for (let i = 0; i < setPieces.length; i++) { // For each element of the model, so of the bar\n     barContainer.removeChild(setPieces[i].tile)\n  }\n  // svuotare setPieces\n  setPieces = []\n  createSet()\n}\n\nchangeSet.onclick = change_set\n\n// ------------------------------------------------- DRAG and DROP --------------------------------\n// Creo l'array \"boxes\" che contenga i contenitori box creati creati in html a cui dare le funzionalità di drop\nlet rowCollection = document.getElementById(\"table\").children;\nlet boxes = [];\nfor (let i = 0; i < rows; i++) {\n    let rowChild = rowCollection[i].children;\n    for (let j = 0; j < boxesPerRow; j++) {\n        boxes.push(rowChild[j]);\n    }\n}\n\n// Funzioni ausiliarie che permettono la cancellazione dell'eventiListener quando serve.\nfunction add_drop() {drop(event)};\nfunction add_prevent_drop() {prevent_drop(event)};\n\n// PreventDefault() impedisce che all'evento a cui è legato sia associata un'azione di default del browser.\n// Per esempio se in mozilla, per default, l'evento dragover aziona il drop siamo fregati.\nfunction prevent_drop(ev) {\n  ev.preventDefault();\n}\n\n// Dato l'evento drag su un elemento ne raccoglie i dati avendo come argomento l'ID dell'elemento stesso.\n// Inoltre, draggando una tessera, raccoglie l'indice della stessa passando per il parent \"bar\"\nfunction drag(ev) {\n  ev.dataTransfer.setData(\"text\", ev.target.id);\n  let i =  Array.from(ev.currentTarget.parentNode.children).indexOf(ev.currentTarget)\n  return i;\n}\n\n// Assegna solamente al primo elemento senza figli dell'array dato gli eventListeners necessari a permettere il drop\n// al suo interno e toglie l'attributo draggable all'ultima tessera inserita.\nfunction drop_box(array) {\n  let i = 0;\n  while(array[i]) {\n    if (array[i-1]) {\n      array[i-1].children[0].setAttribute(\"draggable\", false);\n    }\n    if (array[i].children.length == 0) {\n      array[i].addEventListener(\"drop\", add_drop);\n      array[i].addEventListener(\"dragover\", add_prevent_drop);\n      break;\n    }\n    i++;\n  }\n}\ndrop_box(boxes);\n\n// Dato l'evento drop, trasferisce i dati dell'elemento in drag all'elemento container in cui si vuole droppare tramite l'id.\n// La splice su setPieces serve a rimuovere dall'array la tessera appena droppata per far sì che la funzione rotate\n// continui a funzionare tramite l'indice pieceNum preso dall'elemento \"bar\" tramite il drag\nfunction drop(ev) {\n  if (ev.target.children.length === 0) {\n    //controllo che la casella e la tessera siano entrambe orizzontali\n    if (ev.target.style.width == dim2+\"px\" && (setPieces[pieceNum].angle == 90 || setPieces[pieceNum].angle == 270)) {\n      if((Math.floor((ev.target.id)/boxesPerRow))%2==0 && result.length != 0 && result[result.length-1]!=setPieces[pieceNum].grade1){\n        cartoonFeedback(\"color_match\");\n      }else if((Math.floor((ev.target.id)/boxesPerRow))%2!=0 && result.length != 0 && result[result.length-1]!=setPieces[pieceNum].grade2){\n        cartoonFeedback(\"color_match\");\n      }else{\n      ev.target.textContent= \"\";\n      ev.preventDefault();\n      var data = ev.dataTransfer.getData(\"text\");\n      ev.target.appendChild(document.getElementById(data));\n      // prima di toglierlo da setPieces metto i grades del pezzo in questa funzione che crea result\n      addToSequence(setPieces[pieceNum].grade1, setPieces[pieceNum].grade2,ev.target.id);\n      setPieces.splice(pieceNum, 1);\n      ev.target.firstElementChild.removeEventListener(\"dblclick\", call_rotate);\n      ev.target.removeEventListener(\"drop\", add_drop);\n      ev.target.removeEventListener(\"dragover\", add_prevent_drop);\n      drop_box(boxes);\n      }\n    }\n    //controllo che la casella e la tessera siano entrambe verticali\n    else if (ev.target.style.width == dim1+\"px\" && (setPieces[pieceNum].angle == 0 || setPieces[pieceNum].angle == 180)) {\n      if(result[result.length-1]!=setPieces[pieceNum].grade1){\n        cartoonFeedback(\"color_match\");\n      }else{\n        ev.target.textContent =\"\";\n        ev.preventDefault();\n        var data = ev.dataTransfer.getData(\"text\");\n        ev.target.appendChild(document.getElementById(data));\n        // prima di toglierlo da setPieces metto i grades del pezzo in questa funzione che crea result\n        addToSequence(setPieces[pieceNum].grade1, setPieces[pieceNum].grade2,1);\n        // passo 2 come id perchè i pezzi verticali si comportano sempre come se fossero in una riga pari\n        setPieces.splice(pieceNum, 1);\n        ev.target.firstElementChild.removeEventListener(\"dblclick\", call_rotate);\n        ev.target.removeEventListener(\"drop\", add_drop);\n        ev.target.removeEventListener(\"dragover\", add_prevent_drop);\n        drop_box(boxes);\n      }\n    }else{\n      cartoonFeedback(\"wrong_rotation\");\n    }\n  }\n\n}\n\n// this function adds the tile\nfunction addToSequence(grade1,grade2,id){\n  if(id==0){\n    result.push(grade1,grade2);\n  }else if(Math.floor((id)/boxesPerRow)%2==0){\n    //result.push(grade1,grade2);\n    result.push(grade2);\n  }else{\n    //result.push(grade2,grade1);\n    result.push(grade1);\n  }\n\n  hiddenField.setAttribute(\"value\", result.join('_'));\n  // in questo momento in result ci sono i \"doppioni\"\n}\n\n// questa funzione in base al parametro, che dipende dal tipo di feedback che devo dare,\n// fa comparire il fumetto con il commento\nfunction cartoonFeedback(feedback){\n  let cartoon = document.getElementById(\"cartoon\");\n  cartoon.style.display = \"inherit\";\n  if(feedback==\"color_match\"){\n    cartoon.textContent = \"Remember to match the color!\";\n\n  }\n  if(feedback==\"wrong_rotation\"){\n    cartoon.textContent = \"Remember you can rotate the tile!\";\n  }\n  setTimeout(function(){cartoon.style.display=\"none\"}, 2000);\n}\n//------------------------------------------- END of DRAG and DROP ---------------------------\n\n// ------------ TIMER controller ------------------\ntimer.startTimer();\n\n//-----------------------------------------------END of CONTROLLER--------------------------------------------------------------\n"]}